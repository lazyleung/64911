; Unit Test for HallButtonControl
; Eric NewHall, Jonathan Leung, Mengzhe Li, Ting Xu
; 18649 Fall 2014
; Group 11


;#INCLUDE HallButtonControlDefines.mf
; can IDs used:
; DoorClosed Front Left = 0x0d145000
#DEFINE DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID 0x0D145000
; DoorClosed Front Right = 0x0D145001
#DEFINE DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID 0x0D145001

#DEFINE MESSAGE_PERIOD 0.1s

; AtFloor = 0xC4C2806
#DEFINE AT_FLOOR_[4][FRONT]_CAN_ID 0xC4C2806

; DesiredFloor
#DEFINE DESIRED_FLOOR_CAN_ID 0xF0CB600

; HallCall and HallLight
#DEFINE HALL_CALL_[4][FRONT][UP]_CAN_ID                0xF0FB90C
#DEFINE HALL_LIGHT_[4][FRONT][UP]_CAN_ID               0xF10B90C
#DEFINE HALL_CALL_[4][FRONT][DOWN]_CAN_ID              0xF0FB90D
#DEFINE HALL_LIGHT_[4][FRONT][DOWN]_CAN_ID             0xF10B90D

;initialize
0s I MESSAGE_PERIOD F HallCall 4 FRONT UP = false
0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = true
0s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = true

;#state 'S8.1 IDLE'
0.21s  A F HallLight 4 FRONT UP : lighted == false
0.21s  A N HALL_CALL_[4][FRONT][UP]_CAN_ID Boolean : getValue == false
0.21s  A N HALL_LIGHT_[4][FRONT][UP]_CAN_ID Boolean : getValue == false

;#transition 'T8.1'
0.71s I MESSAGE_PERIOD F HallCall 4 FRONT UP = true
0.71s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = true
0.71s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = true

;#state 'S8.2 REGISTER_CALL'
1.21s  A F HallLight 4 FRONT UP : lighted == true
1.21s  A N HALL_CALL_[4][FRONT][UP]_CAN_ID Boolean : getValue == true
1.21s  A N HALL_LIGHT_[4][FRONT][UP]_CAN_ID Boolean : getValue == true

;#transition 'T8.2'
1.71s I MESSAGE_PERIOD N AT_FLOOR_[4][FRONT]_CAN_ID AtFloor 4 FRONT = true
1.71s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 6 UP FRONT
1.71s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = false

;#state 'S8.1 IDLE'
2.21s  A F HallLight 4 FRONT UP : lighted == false
2.21s  A N HALL_CALL_[4][FRONT][UP]_CAN_ID Boolean : getValue == false
2.21s  A N HALL_LIGHT_[4][FRONT][UP]_CAN_ID Boolean : getValue == false

;#transition 'T8.1'
2.71s I MESSAGE_PERIOD F HallCall 4 FRONT UP = true
2.71s I MESSAGE_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = false
2.71s I MESSAGE_PERIOD N AT_FLOOR_[4][FRONT]_CAN_ID AtFloor 4 FRONT = true
2.71s I MESSAGE_PERIOD N DESIRED_FLOOR_CAN_ID DesiredFloor = 3 STOP FRONT

;#sate 'S8.2 REGISTER_CALL'
3.21s  A F HallLight 4 FRONT UP : lighted == true
3.21s  A N HALL_CALL_[4][FRONT][UP]_CAN_ID Boolean : getValue == true
3.21s  A N HALL_LIGHT_[4][FRONT][UP]_CAN_ID Boolean : getValue == true
